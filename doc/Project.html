<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Project
  
    &mdash; Documentation by YARD 0.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (P)</a> &raquo; 
    
    
    <span class="title">Project</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Project
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ActiveRecord::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next">Project</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/models/project.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="per_page-classvariable" class="">@@per_page =
          
        </dt>
        <dd><pre class="code"><span class='int'>10</span></pre></dd>
      
    </dl>
  


  


  

  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_kqs_have_extforms-class_method" title="all_kqs_have_extforms (class method)">+ (Object) <strong>all_kqs_have_extforms</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_arms_array-class_method" title="get_arms_array (class method)">+ (Object) <strong>get_arms_array</strong>(project_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
return a unique list of all arms that have been entered under a given
project (referenced by ID).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_notes_string-class_method" title="get_notes_string (class method)">+ (Object) <strong>get_notes_string</strong>(id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_num_ext_forms-class_method" title="get_num_ext_forms (class method)">+ (Object) <strong>get_num_ext_forms</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_num_key_qs-class_method" title="get_num_key_qs (class method)">+ (Object) <strong>get_num_key_qs</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_num_kqs_with_ext_forms-class_method" title="get_num_kqs_with_ext_forms (class method)">+ (Object) <strong>get_num_kqs_with_ext_forms</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_num_kqs_without_ext_forms-class_method" title="get_num_kqs_without_ext_forms (class method)">+ (Object) <strong>get_num_kqs_without_ext_forms</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_num_studies-class_method" title="get_num_studies (class method)">+ (Object) <strong>get_num_studies</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_outcomes_array-class_method" title="get_outcomes_array (class method)">+ (Object) <strong>get_outcomes_array</strong>(project_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
return a unique list of all outcomes that have been entered under a given
project (referenced by ID).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_collabs_string-class_method" title="get_project_collabs_string (class method)">+ (Object) <strong>get_project_collabs_string</strong>(p_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_leads_array-class_method" title="get_project_leads_array (class method)">+ (Object) <strong>get_project_leads_array</strong>(p_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_leads_emails_array-class_method" title="get_project_leads_emails_array (class method)">+ (Object) <strong>get_project_leads_emails_array</strong>(p_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_leads_string-class_method" title="get_project_leads_string (class method)">+ (Object) <strong>get_project_leads_string</strong>(p_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_string_from_all_projects-class_method" title="get_project_string_from_all_projects (class method)">+ (Object) <strong>get_project_string_from_all_projects</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_project_string_from_lead_roles-class_method" title="get_project_string_from_lead_roles (class method)">+ (Object) <strong>get_project_string_from_lead_roles</strong>(lead_roles) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_status_string-class_method" title="get_status_string (class method)">+ (Object) <strong>get_status_string</strong>(id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_studies-class_method" title="get_studies (class method)">+ (Object) <strong>get_studies</strong>(project_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_ready_for_studies-class_method" title="is_ready_for_studies (class method)">+ (Object) <strong>is_ready_for_studies</strong>(proj_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
determine if a project is ready for studies to be extracted.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#moveup-class_method" title="moveup (class method)">+ (Object) <strong>moveup</strong>(project_id, keyq) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_key_questions_accounted_for-instance_method" title="#all_key_questions_accounted_for (instance method)">- (Object) <strong>all_key_questions_accounted_for</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
determine whether or not every key question in the  project is  assigned to
an extraction form.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_excel_zip-instance_method" title="#download_excel_zip (instance method)">- (Object) <strong>download_excel_zip</strong>(file_list, user) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_extraction_form_options-instance_method" title="#has_extraction_form_options (instance method)">- (Object) <strong>has_extraction_form_options</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
return a boolean of whether or not a project has extraction_forms available
uses the get_extraction_form_list array function found in the study model.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_xls-instance_method" title="#to_xls (instance method)">- (Object) <strong>to_xls</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
format the project into a group of excel documents project information
(description, key questions, users) extraction forms studies extracted
data.
</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="all_kqs_have_extforms-class_method">
  
    + (<tt>Object</tt>) <strong>all_kqs_have_extforms</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 152</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_all_kqs_have_extforms'>all_kqs_have_extforms</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_get_num_kqs_without_ext_forms'>get_num_kqs_without_ext_forms</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_num'>num</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='kw'>return</span> <span class='kw'>true</span>
	<span class='kw'>else</span>
		<span class='kw'>return</span> <span class='kw'>false</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_arms_array-class_method">
  
    + (<tt>Object</tt>) <strong>get_arms_array</strong>(project_id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
return a unique list of all arms that have been entered under a given
project (referenced by ID). We only need to return the names of the arms in
the following format:
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 212</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_arms_array'>get_arms_array</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_proj'>proj</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_studies'>studies</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_get_studies'>get_studies</span><span class='lparen'>(</span><span class='id identifier rubyid_proj'>proj</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_proj_arms'>proj_arms</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
	<span class='id identifier rubyid_arm_descriptions'>arm_descriptions</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
	<span class='kw'>for</span> <span class='id identifier rubyid_study'>study</span> <span class='kw'>in</span> <span class='id identifier rubyid_studies'>studies</span>
		<span class='id identifier rubyid_records'>records</span> <span class='op'>=</span> <span class='const'>Arm</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:study_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_study'>study</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
		<span class='id identifier rubyid_proj_arms'>proj_arms</span> <span class='op'>+=</span> <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbrace'>}</span>
		<span class='kw'>unless</span> <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
			<span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
				<span class='kw'>if</span> <span class='id identifier rubyid_arm_descriptions'>arm_descriptions</span><span class='lbracket'>[</span><span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_arm_descriptions'>arm_descriptions</span><span class='lbracket'>[</span><span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
					<span class='id identifier rubyid_arm_descriptions'>arm_descriptions</span><span class='lbracket'>[</span><span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span>					
				<span class='kw'>end</span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='id identifier rubyid_proj_arms'>proj_arms</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span>
	<span class='id identifier rubyid_proj_arms'>proj_arms</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
	<span class='id identifier rubyid_proj_arms'>proj_arms</span> <span class='op'>=</span> <span class='id identifier rubyid_proj_arms'>proj_arms</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span><span class='id identifier rubyid_x'>x</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
	<span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_proj_arms'>proj_arms</span><span class='comma'>,</span><span class='id identifier rubyid_arm_descriptions'>arm_descriptions</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_notes_string-class_method">
  
    + (<tt>Object</tt>) <strong>get_notes_string</strong>(id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 27</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_notes_string'>get_notes_string</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
	<span class='ivar'>@notes</span> <span class='op'>=</span> <span class='const'>StickyNote</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@notes</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> Notes</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_num_ext_forms-class_method">
  
    + (<tt>Object</tt>) <strong>get_num_ext_forms</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 132</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_num_ext_forms'>get_num_ext_forms</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@ext_forms</span> <span class='op'>=</span> <span class='const'>ExtractionForm</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@ext_forms</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_num_key_qs-class_method">
  
    + (<tt>Object</tt>) <strong>get_num_key_qs</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 126</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_num_key_qs'>get_num_key_qs</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@key_qs</span> <span class='op'>=</span> <span class='const'>KeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@key_qs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_num_kqs_with_ext_forms-class_method">
  
    + (<tt>Object</tt>) <strong>get_num_kqs_with_ext_forms</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 138</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_num_kqs_with_ext_forms'>get_num_kqs_with_ext_forms</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@kqs</span> <span class='op'>=</span> <span class='const'>KeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='ivar'>@ext_form_kq_entries</span> <span class='op'>=</span> <span class='const'>ExtractionFormKeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:key_question_id</span> <span class='op'>=&gt;</span> <span class='ivar'>@kqs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@ext_form_kq_entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_num_kqs_without_ext_forms-class_method">
  
    + (<tt>Object</tt>) <strong>get_num_kqs_without_ext_forms</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 145</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_num_kqs_without_ext_forms'>get_num_kqs_without_ext_forms</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@kqs</span> <span class='op'>=</span> <span class='const'>KeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='ivar'>@ext_form_kq_entries</span> <span class='op'>=</span> <span class='const'>ExtractionFormKeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:key_question_id</span> <span class='op'>=&gt;</span> <span class='ivar'>@kqs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@kqs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='ivar'>@ext_form_kq_entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_num_studies-class_method">
  
    + (<tt>Object</tt>) <strong>get_num_studies</strong>(project) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 120</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_num_studies'>get_num_studies</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='ivar'>@studies</span> <span class='op'>=</span> <span class='const'>Study</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@studies</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_outcomes_array-class_method">
  
    + (<tt>Object</tt>) <strong>get_outcomes_array</strong>(project_id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
return a unique list of all outcomes that have been entered under a given
project (referenced by ID)
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 185</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_outcomes_array'>get_outcomes_array</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_proj'>proj</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_studies'>studies</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_get_studies'>get_studies</span><span class='lparen'>(</span><span class='id identifier rubyid_proj'>proj</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_proj_ocs'>proj_ocs</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
	<span class='id identifier rubyid_oc_descriptions'>oc_descriptions</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
	<span class='kw'>for</span> <span class='id identifier rubyid_study'>study</span> <span class='kw'>in</span> <span class='id identifier rubyid_studies'>studies</span>
		<span class='id identifier rubyid_outcomes'>outcomes</span> <span class='op'>=</span> <span class='const'>Outcome</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:study_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_study'>study</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
		<span class='kw'>unless</span> <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_oc'>oc</span><span class='op'>|</span>
				<span class='id identifier rubyid_proj_ocs'>proj_ocs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span>
				
				<span class='kw'>if</span> <span class='id identifier rubyid_oc_descriptions'>oc_descriptions</span><span class='lbracket'>[</span><span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
					<span class='id identifier rubyid_oc_descriptions'>oc_descriptions</span><span class='lbracket'>[</span><span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='comma'>,</span> <span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_outcome_type'>outcome_type</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_oc'>oc</span><span class='period'>.</span><span class='id identifier rubyid_outcome_type'>outcome_type</span><span class='rbracket'>]</span>
				<span class='kw'>end</span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='id identifier rubyid_proj_ocs'>proj_ocs</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span>
	<span class='id identifier rubyid_proj_ocs'>proj_ocs</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
	<span class='id identifier rubyid_proj_ocs'>proj_ocs</span> <span class='op'>=</span> <span class='id identifier rubyid_proj_ocs'>proj_ocs</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
	<span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_proj_ocs'>proj_ocs</span><span class='comma'>,</span><span class='id identifier rubyid_oc_descriptions'>oc_descriptions</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_collabs_string-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_collabs_string</strong>(p_id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 106</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_collabs_string'>get_project_collabs_string</span><span class='lparen'>(</span><span class='id identifier rubyid_p_id'>p_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user_roles</span> <span class='op'>=</span> <span class='const'>UserProjectRole</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span><span class='id identifier rubyid_p_id'>p_id</span><span class='comma'>,</span> <span class='symbol'>:role</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>editor</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='ivar'>@user_names</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	<span class='kw'>for</span> <span class='id identifier rubyid_u'>u</span> <span class='kw'>in</span> <span class='ivar'>@user_roles</span>
		<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='ivar'>@user_names</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_fname'>fname</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_lname'>lname</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='ivar'>@user_names</span><span class='period'>.</span><span class='id identifier rubyid_to_sentence'>to_sentence</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_leads_array-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_leads_array</strong>(p_id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 78</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_leads_array'>get_project_leads_array</span><span class='lparen'>(</span><span class='id identifier rubyid_p_id'>p_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user_roles</span> <span class='op'>=</span> <span class='const'>UserProjectRole</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span><span class='id identifier rubyid_p_id'>p_id</span><span class='comma'>,</span> <span class='symbol'>:role</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lead</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='kw'>return</span> <span class='ivar'>@user_roles</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_leads_emails_array-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_leads_emails_array</strong>(p_id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 83</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_leads_emails_array'>get_project_leads_emails_array</span><span class='lparen'>(</span><span class='id identifier rubyid_p_id'>p_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user_roles</span> <span class='op'>=</span> <span class='const'>UserProjectRole</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span><span class='id identifier rubyid_p_id'>p_id</span><span class='comma'>,</span> <span class='symbol'>:role</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lead</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='ivar'>@user_emails</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	<span class='kw'>for</span> <span class='id identifier rubyid_u'>u</span> <span class='kw'>in</span> <span class='ivar'>@user_roles</span>
		<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
		<span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='ivar'>@user_emails</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='ivar'>@user_emails</span>	
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_leads_string-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_leads_string</strong>(p_id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 66</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_leads_string'>get_project_leads_string</span><span class='lparen'>(</span><span class='id identifier rubyid_p_id'>p_id</span><span class='rparen'>)</span>
	<span class='ivar'>@user_roles</span> <span class='op'>=</span> <span class='const'>UserProjectRole</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span><span class='id identifier rubyid_p_id'>p_id</span><span class='comma'>,</span> <span class='symbol'>:role</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lead</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='ivar'>@user_names</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
	<span class='kw'>for</span> <span class='id identifier rubyid_u'>u</span> <span class='kw'>in</span> <span class='ivar'>@user_roles</span>
		<span class='ivar'>@user</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
		<span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='ivar'>@user_names</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_fname'>fname</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_lname'>lname</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='ivar'>@user_names</span><span class='period'>.</span><span class='id identifier rubyid_to_sentence'>to_sentence</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_string_from_all_projects-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_string_from_all_projects</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51
52
53
54
55
56</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 49</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_string_from_all_projects'>get_project_string_from_all_projects</span><span class='lparen'>(</span><span class='rparen'>)</span>
	<span class='ivar'>@projects</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
	<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>for</span> <span class='id identifier rubyid_proj'>proj</span> <span class='kw'>in</span> <span class='ivar'>@projects</span>
		<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>+</span> <span class='id identifier rubyid_proj'>proj</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_project_string_from_lead_roles-class_method">
  
    + (<tt>Object</tt>) <strong>get_project_string_from_lead_roles</strong>(lead_roles) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 58</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_project_string_from_lead_roles'>get_project_string_from_lead_roles</span><span class='lparen'>(</span><span class='id identifier rubyid_lead_roles'>lead_roles</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>for</span> <span class='id identifier rubyid_role'>role</span> <span class='kw'>in</span> <span class='id identifier rubyid_lead_roles'>lead_roles</span>
		<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>+</span> <span class='id identifier rubyid_role'>role</span><span class='period'>.</span><span class='id identifier rubyid_project_id'>project_id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_status_string-class_method">
  
    + (<tt>Object</tt>) <strong>get_status_string</strong>(id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 18</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_status_string'>get_status_string</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
	<span class='ivar'>@project</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
	<span class='kw'>if</span> <span class='ivar'>@project</span><span class='period'>.</span><span class='id identifier rubyid_is_public'>is_public</span>
		<span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Complete (Public)</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>else</span>
		<span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Incomplete (Private)</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_studies-class_method">
  
    + (<tt>Object</tt>) <strong>get_studies</strong>(project_id) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 116</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_studies'>get_studies</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='kw'>return</span> <span class='const'>Study</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="is_ready_for_studies-class_method">
  
    + (<tt>Object</tt>) <strong>is_ready_for_studies</strong>(proj_id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
determine if a project is ready for studies to be extracted.  studies can
be extracted if: 
</p>
<pre class="code">
 * there are key questions assigned to the project
 * there are extraction forms for the project
 * each key question assigned has an extraction form assigned to it</pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 239</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_ready_for_studies'>is_ready_for_studies</span><span class='lparen'>(</span><span class='id identifier rubyid_proj_id'>proj_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_reasons'>reasons</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='semicolon'>;</span>
	<span class='id identifier rubyid_ready'>ready</span> <span class='op'>=</span> <span class='kw'>true</span><span class='semicolon'>;</span>	
	
	<span class='comment'># get the project
</span>	<span class='id identifier rubyid_proj'>proj</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_proj_id'>proj_id</span><span class='rparen'>)</span><span class='semicolon'>;</span>
	
	<span class='comment'># if it does not have an extraction form, set ready to false and add the reason
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_proj'>proj</span><span class='period'>.</span><span class='id identifier rubyid_extraction_forms'>extraction_forms</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='id identifier rubyid_ready'>ready</span> <span class='op'>=</span> <span class='kw'>false</span><span class='semicolon'>;</span>
		<span class='id identifier rubyid_reasons'>reasons</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are no extraction forms associated with this project.</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	
	<span class='id identifier rubyid_kqs'>kqs</span> <span class='op'>=</span> <span class='id identifier rubyid_proj'>proj</span><span class='period'>.</span><span class='id identifier rubyid_key_questions'>key_questions</span>
	<span class='comment'># if it does not have key questions, set ready to false and add the reason
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_kqs'>kqs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
		<span class='id identifier rubyid_ready'>ready</span> <span class='op'>=</span> <span class='kw'>false</span><span class='semicolon'>;</span>
		<span class='id identifier rubyid_reasons'>reasons</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are no key questions associated with this project.</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='comment'># if it has key questions, then determine if they've been accounted for by an extraction form
</span>	<span class='comment'>#else
</span>	<span class='comment'>#	kqids = kqs.collect{|record| record.id};
</span>	<span class='comment'>#	num_accounted = ExtractionFormKeyQuestion.find(:all, :conditions=&gt;[&quot;key_question_id IN (?)&quot;,kqids]).length;
</span>	<span class='comment'>#	unless kqids.length == num_accounted
</span>	<span class='comment'>#		ready = false
</span>	<span class='comment'>#		reasons &lt;&lt; &quot;Not all key questions have been assigned to an extraction form for this project.&quot;
</span>	<span class='comment'>#	end
</span>	<span class='comment'>#end		
</span>	
	<span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_ready'>ready</span><span class='comma'>,</span> <span class='id identifier rubyid_reasons'>reasons</span><span class='rbracket'>]</span>
	
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="moveup-class_method">
  
    + (<tt>Object</tt>) <strong>moveup</strong>(project_id, keyq) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 161</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_moveup'>moveup</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='comma'>,</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='rparen'>)</span>
	<span class='ivar'>@proj</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_project_id'>project_id</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_keyq_id'>keyq_id</span> <span class='op'>=</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>&gt;</span> <span class='int'>1</span>
		<span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>=</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>-</span> <span class='int'>1</span>
		<span class='ivar'>@proj_kqs</span> <span class='op'>=</span> <span class='const'>KeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:project_id</span> <span class='op'>=&gt;</span> <span class='ivar'>@proj</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
		<span class='kw'>for</span> <span class='id identifier rubyid_kq'>kq</span> <span class='kw'>in</span> <span class='ivar'>@proj_kqs</span>
			<span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_kq'>kq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>==</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_kq'>kq</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>!=</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
				<span class='id identifier rubyid_kq'>kq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>=</span> <span class='id identifier rubyid_kq'>kq</span><span class='period'>.</span><span class='id identifier rubyid_question_number'>question_number</span> <span class='op'>+</span> <span class='int'>1</span>
				<span class='id identifier rubyid_kq'>kq</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_keyq'>keyq</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>  
		<span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span>
			<span class='id identifier rubyid_render'>render</span> <span class='symbol'>:update</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page'>page</span><span class='op'>|</span>
				<span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_replace_html'>replace_html</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key_question_table</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:partial</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key_questions/table</span><span class='tstring_end'>'</span></span>
			<span class='kw'>end</span>
		<span class='rbrace'>}</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="all_key_questions_accounted_for-instance_method">
  
    - (<tt>Object</tt>) <strong>all_key_questions_accounted_for</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
determine whether or not every key question in the  project is  assigned to
an extraction form. If so, users should not be able to create new
extraction forms for their project.
</p>
<p>
return a boolean true or false
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_key_questions_accounted_for'>all_key_questions_accounted_for</span>
	<span class='id identifier rubyid_retVal'>retVal</span> <span class='op'>=</span> <span class='kw'>false</span><span class='semicolon'>;</span>
	<span class='id identifier rubyid_kqs'>kqs</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_key_questions'>key_questions</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span> <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span>
	<span class='id identifier rubyid_kq_length'>kq_length</span> <span class='op'>=</span> <span class='id identifier rubyid_kqs'>kqs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
	<span class='id identifier rubyid_junction'>junction</span> <span class='op'>=</span> <span class='const'>ExtractionFormKeyQuestion</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='comma'>,</span> <span class='symbol'>:conditions</span><span class='op'>=&gt;</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key_question_id IN (?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_kqs'>kqs</span><span class='rbracket'>]</span><span class='rparen'>)</span>
	
	<span class='kw'>if</span> <span class='id identifier rubyid_kq_length'>kq_length</span> <span class='op'>==</span> <span class='id identifier rubyid_junction'>junction</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
		<span class='id identifier rubyid_retVal'>retVal</span> <span class='op'>=</span> <span class='kw'>true</span><span class='semicolon'>;</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_retVal'>retVal</span>	
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="download_excel_zip-instance_method">
  
    - (<tt>Object</tt>) <strong>download_excel_zip</strong>(file_list, user) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


298
299
300
301
302
303
304
305
306
307
308
309</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 298</span>

<span class='kw'>def</span> <span class='id identifier rubyid_download_excel_zip'>download_excel_zip</span><span class='lparen'>(</span><span class='id identifier rubyid_file_list'>file_list</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span>
<span class='id identifier rubyid_retVal'>retVal</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_file_list'>file_list</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  	<span class='id identifier rubyid_zipped'>zipped</span> <span class='op'>=</span> <span class='const'>Zippy</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='rbrace'>}</span><span class='tstring_content'>_project_export.zip</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_zip'>zip</span><span class='op'>|</span>
      <span class='id identifier rubyid_file_list'>file_list</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
      	<span class='id identifier rubyid_zip'>zip</span><span class='lbracket'>[</span><span class='id identifier rubyid_file'>file</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
  	<span class='kw'>end</span>
  	<span class='id identifier rubyid_retVal'>retVal</span> <span class='op'>=</span> <span class='id identifier rubyid_zipped'>zipped</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_retVal'>retVal</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="has_extraction_form_options-instance_method">
  
    - (<tt>Object</tt>) <strong>has_extraction_form_options</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
return a boolean of whether or not a project has extraction_forms available
uses the get_extraction_form_list array function found in the study model
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_extraction_form_options'>has_extraction_form_options</span>
	<span class='id identifier rubyid_has_extraction_form'>has_extraction_form</span> <span class='op'>=</span> <span class='kw'>false</span>
	<span class='id identifier rubyid_extraction_forms'>extraction_forms</span> <span class='op'>=</span> <span class='const'>Study</span><span class='period'>.</span><span class='id identifier rubyid_get_extraction_form_list_array'>get_extraction_form_list_array</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
	<span class='kw'>unless</span> <span class='id identifier rubyid_extraction_forms'>extraction_forms</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
		<span class='id identifier rubyid_has_extraction_form'>has_extraction_form</span> <span class='op'>=</span> <span class='kw'>true</span>
	<span class='kw'>end</span>
		<span class='kw'>return</span> <span class='id identifier rubyid_has_extraction_form'>has_extraction_form</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_xls-instance_method">
  
    - (<tt>Object</tt>) <strong>to_xls</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
format the project into a group of excel documents project information
(description, key questions, users) extraction forms studies extracted data
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/project.rb', line 277</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_xls'>to_xls</span>
  
	<span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='op'>::</span><span class='const'>Workbook</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='comment'># start the excel document
</span>	
	<span class='comment'># create the project information worksheet
</span>	<span class='id identifier rubyid_tab1'>tab1</span> <span class='op'>=</span> <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_create_worksheet'>create_worksheet</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Project Information</span><span class='tstring_end'>&quot;</span></span>
	
	<span class='comment'># write a few lines to the sheet
</span>	<span class='id identifier rubyid_tab1'>tab1</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>This</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>is</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>file</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>1</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>row</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>1</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_tab1'>tab1</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>This</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>is</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>file</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>1</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>row</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>2</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_tab1'>tab1</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>This</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>is</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>file</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>1</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>row</span><span class='tstring_end'>'</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>3</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
	
	<span class='id identifier rubyid_doc2'>doc2</span> <span class='op'>=</span> <span class='const'>Spreadsheet</span><span class='op'>::</span><span class='const'>Workbook</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
	<span class='id identifier rubyid_d2t1'>d2t1</span> <span class='op'>=</span> <span class='id identifier rubyid_doc2'>doc2</span><span class='period'>.</span><span class='id identifier rubyid_create_worksheet'>create_worksheet</span> <span class='symbol'>:name</span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>P1</span><span class='tstring_end'>'</span></span>
	<span class='id identifier rubyid_d2t1'>d2t1</span><span class='period'>.</span><span class='id identifier rubyid_row'>row</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a little somethin somethin for doc 2</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='rbrace'>}</span><span class='tstring_content'>_ef_1.xls</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='rbrace'>}</span><span class='tstring_content'>_ef_2.xls</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span>
	<span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_files'>files</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_doc2'>doc2</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_files'>files</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>return</span> <span class='id identifier rubyid_files'>files</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed Feb  1 16:26:47 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.2).
</div>

  </body>
</html>