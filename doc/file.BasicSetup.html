<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ASCII-8BIT" />
<title>
  File: Basic Setup
  
    &mdash; Documentation by YARD 0.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: Basic Setup</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Basic Setup</h1>
<h2>File Structure</h2>
<p>
The SRDR file system is set up according to the default directory layout
used by Ruby on Rails. Files specific to the SRDR system can be found in
the following directories:
</p>
<ul>
<li><p>
app
</p>
</li>
<li><p>
config
</p>
</li>
<li><p>
db
</p>
</li>
<li><p>
public
</p>
</li>
<li><p>
doc
</p>
</li>
</ul>
<p>
Details regarding items in these directories are found in the following
sections.
</p>
<h3>app</h3>
<p>
The Systematic Review Data Repository system is built based on the
Model-View-Controller (MVC) software architecture. This concept attempts to
form a clear division between code defining the user interface elements and
the underlying logic driving the system. This is accomplished by shuttling
messages between the Models (database tables) and Views (user interface)
through what is known as a controller class.
</p>
<p>
All of the files relating to SRDR that are involved in this MVC
architecture are found in the app directory. In keeping with the division
of system tasks, the associated files are laid out in a similar fashion.
</p>
<p>
The app directory is divided into the following sections:
</p>
<table>
<tr><td valign="top">controllers</td><td><ul>
<li><p>
a collection of .rb formatted Ruby Classes
</p>
</li>
</ul>
<ul>
<li><p>
the interface between the database and the web server / user interface
</p>
</li>
</ul>
<ul>
<li><p>
functions defined in the ApplicationController are inherited by all other
controllers
</p>
</li>
</ul>
</td></tr>
<tr><td valign="top">helpers</td><td><ul>
<li><p>
a collection of .rb formatted Ruby modules
</p>
</li>
</ul>
<ul>
<li><p>
these ruby functions are accessible from within SRDR views.
</p>
</li>
</ul>
<ul>
<li><p>
ApplicationHelper is available from all views
</p>
</li>
</ul>
<ul>
<li><p>
Carry out functions such as creating breadcrumb links on each page,
calculating back/continue buttons, etc.
</p>
</li>
</ul>
</td></tr>
<tr><td valign="top">models</td><td><ul>
<li><p>
a collection of .rb formatted Ruby Classes
</p>
</li>
</ul>
<ul>
<li><p>
treat database records as objects, write functions to access/modify/remove
those objects
</p>
</li>
</ul>
<ul>
<li><p>
files are named in a singular form according to the database table name
</p>
</li>
</ul>
<ul>
<li><p>
ex:  study.rb corresponds to the &#8220;studies&#8221; database table
</p>
</li>
</ul>
</td></tr>
<tr><td valign="top">views</td><td><ul>
<li><p>
collection of .html.erb formatted HTML files with embedded Ruby
</p>
</li>
</ul>
<ul>
<li><p>
each controller has a corresponding view folder
</p>
</li>
</ul>
<ul>
<li><p>
defines what will appear in the user interface
</p>
</li>
</ul>
</td></tr>
<tr><td valign="top">mailers</td><td><ul>
<li><p>
these are designed to set up email procedures, but are not used in the SRDR
system.
</p>
</li>
</ul>
</td></tr>
</table>
<h3>config</h3>
<p>
This directory contains configuration files and instructions for the server
as to how to interpret SRDR calls. In this directory we have the ability to
set many Rails-associated options including URL-to-controller routing.
Routes are required with the creation of any new SRDR controller, and will
hault server execution if they are not found.
</p>
<h3>db</h3>
<p>
The db directory contains database files for the SRDR implementation. This
includes a schema file, the database itself and any rails migrations that
were used for database modification.
</p>
<h3>public</h3>
<p>
Any static html files used in SRDR should be placed within the public
directory. This is also the location of many user interface elements, with
folders named accordingly:
</p>
<ul>
<li><p>
images
</p>
</li>
<li><p>
javascripts
</p>
</li>
<li><p>
stylesheets
</p>
</li>
<li><p>
movies
</p>
</li>
<li><p>
user_manuals
</p>
</li>
</ul>
<p>
Additional files and directories found in the SRDR code base contain
information associated with the Ruby-on-Rails web framework and are
generally not specific to the workings or layout of the SRDR interface. See
the Ruby on Rails web site for further documentation.
</p>
<p>
Images for the AHRQ logo are contained in images/ahrq. Icons used are from
the Wikimedia Commons Silk Icon Library and are saved in the images folder.
More icons can be found at wikimedia: <a
href="http://commons.wikimedia.org/wiki/Silk_icons">commons.wikimedia.org/wiki/Silk_icons</a>.
</p>
<h3>doc</h3>
<p>
This folder contains documentation generated using YARD. All documentation
is generated from comments contained in models, helpers and controllers.
Extra documentation files should be added to the doc/extra folder. They
will appear automatically in this YARD documentation (due to a setting in
the .yardopts config file).
</p>
<p>
To re-generate documentation after updating comments or extra files, run
the command &#8220;yardoc&#8221; from the main srdr folder.
</p>
<p>
For more information on YARD, see <a
href="http://rubydoc.info/docs/yard">rubydoc.info/docs/yard</a>.
</p>
<h2>Programming Languages</h2>
<p>
SRDR uses Ruby 1.9.2p0 (2010-08-18) [i386-mingw32] and Rails 3.0.0. Rails
is a development framework that uses the Model-View-Controller (MVC)
architecture pattern to organize application programming. SRDR uses
.html.erb templates (instead of haml), and various Rails partials to
display tables and maintain consistent layouts and sidebars. JavaScript and
jQuery 1.5 are used for effects, DOM manipulation and ajax functionality.
The jQuery javascript library is included in the header of every page. More
information on jQuery can be found at <a
href="http://www.jquery.com">www.jquery.com</a>.
</p>
<h2>Plugins and Libraries</h2>
<p>
Ruby Gems: the full list of gems used by the Ruby language can be found in
?Gemfile? in the main folder of the SRDR application.
</p>
<ul>
<li><p>
&#8216;heroku&#8217; for using heroku
</p>
</li>
<li><p>
&#8216;sqlite3&#8217; for using the sqlite database locally with rails
</p>
</li>
<li><p>
&#8216;jquery-rails&#8217;, &#8217;>= 0.2.6&#8217; for using jquery as the
default in rails
</p>
</li>
<li><p>
&#8216;authlogic&#8217; for authentication/user registration functionality.
For information on how authlogic works in the project, see: <a
href="https://github.com/binarylogic/authlogic">github.com/binarylogic/authlogic</a>.
For information about how we are using authlogic to facilitate password
retrieval, see: <a
href="http://www.binarylogic.com/2008/11/16/tutorial-reset-passwords-with-authlogic">www.binarylogic.com/2008/11/16/tutorial-reset-passwords-with-authlogic</a>/
</p>
</li>
<li><p>
&#8216;rails3-generators&#8217; for legacy Rails functionality. For more
info see: <a
href="https://github.com/indirect/rails3-generators">github.com/indirect/rails3-generators</a>
</p>
</li>
<li><p>
&#8220;will_paginate&#8221;, &#8220;~> 3.0.pre2&#8221; for pagination
functionality. For more info see: <a
href="https://github.com/mislav/will_paginate/wiki">github.com/mislav/will_paginate/wiki</a>
</p>
</li>
<li><p>
&#8220;nokogiri&#8221; for HTML and XML parsing
</p>
</li>
</ul>
<h2>Rails plugins</h2>
<ul>
<li><p>
nested_form (found in vendor/plugins/nested_form)
</p>
</li>
<li><p>
used to add multiple items with the same form, i.e. Timepoints
</p>
</li>
<li><p>
More info at <a
href="https://github.com/ryanb/nested_form">github.com/ryanb/nested_form</a>
</p>
</li>
</ul>
<h2>Required stylesheets and included javascripts</h2>
<h3>Stylesheets</h3>
<table>
<tr><td valign="top">scaffold.css</td><td><p>
contains most of the SRDR app styling
</p>
</td></tr>
<tr><td valign="top">print.css</td><td><p>
is a stylesheet to display when a user prints a page of SRDR
</p>
</td></tr>
<tr><td valign="top">feedback_button.css</td><td><p>
controls styles for the feedback button on SRDR pages
</p>
</td></tr>
<tr><td valign="top">pagination_styles.css</td><td><p>
handles pagination styles
</p>
</td></tr>
<tr><td valign="top">jquery-ui-1.8.12.custom.css</td><td><p>
contains jquery-ui styles (dialog boxes, tabs, and some form elements)
</p>
</td></tr>
<tr><td valign="top">jquery.qtip.css</td><td><p>
contains styles for the qtip library (see below)
</p>
</td></tr>
<tr><td valign="top">ahrqstyle_new.css</td><td><p>
contains styling information for the AHRQ header and footer
</p>
</td></tr>
<tr><td valign="top">ahrqstyleprint_new.css</td><td><p>
contains styling information for the AHRQ header and footer, optimized for
printing
</p>
</td></tr>
</table>
<h3>Javascripts</h3>
<table>
<tr><td valign="top">application.js</td><td><p>
contains all generally used project javascript, used on all pages
</p>
</td></tr>
<tr><td valign="top">rails.js</td><td><p>
enables jQuery functionality with Rails, used on all pages. This particular
version is generated from the jquery-ujs plugin, which enables rails to use
jquery as the default library (rather than prototype). For more
information: <a
href="https://github.com/rails/jquery-ujs">github.com/rails/jquery-ujs</a>
</p>
</td></tr>
<tr><td valign="top">jquery.min.js</td><td><p>
includes jQuery functionality.
</p>
</td></tr>
<tr><td valign="top">jquery.qtip.js</td><td><p>
enables advanced tooltip functionality for navigation. For more information
see: <a
href="http://craigsworks.com/projects/qtip2">craigsworks.com/projects/qtip2</a>/
</p>
</td></tr>
<tr><td valign="top">nested_form.js</td><td><p>
enables the nested form plugin functionality (such as entering outcome
timepoints). More info at <a
href="https://github.com/ryanb/nested_form">github.com/ryanb/nested_form</a>
</p>
</td></tr>
<tr><td valign="top">jquery-ui-1.8.12.custom.min.js</td><td><p>
enables jquery UI functionality, for creating advanced UI elements, such as
dialog windows and accordion containers. more information at <a
href="http://jqueryui.com">jqueryui.com</a>/
</p>
</td></tr>
<tr><td valign="top">form_complete.js</td><td><p>
enables snomed form completion for outcomes. More information in the NCBI
BioPortal section below.
</p>
</td></tr>
<tr><td valign="top">jquery.printelement.min.js</td><td><p>
used for direct printing of summary pages. more information at <a
href="http://projects.erikzaadi.com/jQueryPlugins/jQuery.printElement">projects.erikzaadi.com/jQueryPlugins/jQuery.printElement</a>/
</p>
</td></tr>
</table>
<p>
the /plugins folder contains extended javascripts for jquery-ui
functionality. The scripts in this folder have equivalent functionality to
jquery-ui-1.8.12.custom.min.js.
</p>
<p>
in folder but not mentioned: easyloader.js, analysis_table_builder.js,
jquery.livequery.js.
</p>
<pre class="code">
  
</pre>
<h2>External APIs</h2>
<h3>Fetching NCBI Publication Information</h3>
<p>
When creating an SRDR study, or set of studies, the user has the option of
providing a PubMed identifier with which information is automatically
pulled from the National Center for Biotechnology Information (NCBI)
website, <a href="http://www.ncbi.nlm.nih.gov">www.ncbi.nlm.nih.gov</a>/.
The NCBI offers an EFetch utility which is used to facilitate this data
retrieval.
</p>
<p>
A url is first formatted according to the specifications at the EFetch
website. Below is a list of the required parameters for fetching literature
information.
</p>
<ul>
<li><p>
base url: <a
href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi">eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi</a>?
</p>
</li>
<li><p>
db: the database of interest
</p>
</li>
<li><p>
id: the identifier for the article of interest
</p>
</li>
<li><p>
mode: the desired format for the file being fetched
</p>
</li>
</ul>
<p>
As an example, the following url will return XML-formatted information from
the pubmed database for an article with the identifier equal to
&#8220;2468246&#8221; <a
href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id=2468246&mode=xml">eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id=2468246&mode=xml</a>
</p>
<p>
Note that the specified parameters define pubmed as the database, 2468246
as the identifier and XML as the mode.  For more information regarding the
EFetch utilities, please see their help page at:  <a
href="http://www.ncbi.nlm.nih.gov/corehtml/query/static/efetchlit_help.html">www.ncbi.nlm.nih.gov/corehtml/query/static/efetchlit_help.html</a>
</p>
<p>
Information contained in this XML file is then parsed out using the
Nokogiri Ruby plugin and displayed to the user, allowing them to save the
journal information without manually typing it in or copying/pasting each
field. This entire transaction takes place in a function known as
get_summary_info_by_pmid, found in the SecondaryPublication model. At the
time of writing this manuscript, the get_summary_info_by_pmid function will
parse study author, title, year, affiliation, journal title, journal volume
and journal issue information.  
</p>
<h3>NCBI BioPortal</h3>
<p>
The NCBO BioPortal is being used in an attempt to standardize user inputs
and introduce a common medical terminology to extracted studies. NCBO
Widgets offer the ability to run an AJAX-enabled search or ontology terms
while the user enters data into a given text field. An example of this can
be found in the Outcome Setup page, which asks the user to specify a name
for their outcome. As the user types the name of their outcome, the widget
will query the NCBO BioPortal and provide suggested outcome names.
</p>
<p>
The following actions are required in order for this dynamic search to take
place:
</p>
<ol>
<li><p>
the form_complete.js javascript file must be included on any page making
use of the widget
</p>
</li>
<li><p>
the class attribute for any input field using the widget must be set
appropriately
</p>
</li>
<li><p>
the class should be ?bp_form_complete_XXXX_YYYY? where XXXX is the code
corresponding to the ontology of interest and YYYY is a choice of which
value to display to the user. For this field, we have the option of uri,
shortid and name.
</p>
</li>
</ol>
<p>
SRDR makes use of SNOMED ontology terms in the outcome setup and definition
pages. Given that the ontology ID for SNOMED is 1353, and the term name is
the desired result, the full class name associated with the input field is:
&#8220;bp_form_complete-1353-name&#8220;
</p>
<p>
For more information regarding the use of NCBO BioPortal and to access
ontology collections, visit <a
href="http://bioportal.bioontology.org">bioportal.bioontology.org</a>/. For
NCBO Widget specifications,  visit <a
href="http://www.bioontology.org/wiki/index.php/NCBO_Widgets">www.bioontology.org/wiki/index.php/NCBO_Widgets</a>
</p>
<h3>Documentation with YARD</h3>
<p>
Documentation is produced using YARD. For information on YARD, see <a
href="http://rubydoc.info/docs/yard">rubydoc.info/docs/yard</a>. 
</p>
<p>
All documentation is generated from comments contained in models, helpers
and controllers.  To generate documentation run this command from the srdr
main folder:
</p>
<pre class="code">
    <span class='id identifier rubyid_yardoc'>yardoc</span>
</pre>
<p>
	 alternatively, use:
</p>
<pre class="code">
    <span class='id identifier rubyid_yard'>yard</span> <span class='id identifier rubyid_doc'>doc</span>
</pre>
<p>
This command will update existing files based on comments that were
changed, and add new files based on new models, controllers, or helpers
that are created.  	 Extra documentation files should be added to the
doc/extra folder. They will appear automatically in this YARD
documentation. To generate documentation from other external files, modify
the .yardopts config file.
</p>
</div></div>
    
    <div id="footer">
  Generated on Wed Feb  1 16:26:46 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.2).
</div>

  </body>
</html>